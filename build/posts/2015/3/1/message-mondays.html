<!doctype html>
<html>
    <head>
        <title>Sam Jacoby | Message Mondays</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

        <meta name="keywords" content="mit, high-low tech, shackman press, lettepress, printing, coding, programming, sam jacoby">
                <meta name="author" content="Neocaridina heteropoda">
        <meta name="email" content="sam@shackmanpress.com">


                
        <link rel="stylesheet" href="/media/css/GGS.css">
        <link rel="stylesheet" href="/media/css/syntax.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
        <style>
        
                </style>
        <link href="feed.xml" type="application/atom+xml" rel="alternate" title="Sam Jacoby | Explorer | Feed">

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/jquery-ui.min.js"></script>
        <script src="/media/js/jquery.timeago.js" type="text/javascript"></script>
        <script src="/media/js/site.js" type="text/javascript"></script>
        <script type="text/javascript" src="//use.typekit.net/emq4jse.js"></script>
        <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

                <script type="text/javascript" src="/media/js/app.js"></script>

        <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js">
        </script>
        <![endif]-->
    </head>
    <body lang="en">
        <header>
            <div>
                <h1><a href="/">Sam Jacoby</a></h1>
                 
            </div>
                                    <nav>
    
<div class="wrapper"><h2><a class="selected"href="/posts/">Posts</a></h2></div><div class="wrapper"><h2><a href="/projects/">Projects</a></h2></div><div class="wrapper"><h2><a href="/printing/">Printing</a></h2></div>
    </nav>
        </header>
        <article  id="twoway"> 
            <article class="post">
    <header>
        <h2 class="title">Message Mondays</h2> 
                        <p class="datetime">
        Posted <time class="timeago" datetime="2015-03-01 14:08:56" pubdate>2015-03-01 14:08:56</time>. 

        <span class="updated">[Last updated <time class="timeago" datetime="2015-04-16 17:48:43" pubdate>2015-04-16 17:48:43</time>. 
]</span>
        </p>
            </header>
    <section>
        <p><em>In this project, I looked at the freeway digital sign alerts in Iowa charted against statewide accident totals, both obtained via <span class="caps">FOIA</span> requests to the Iowa&nbsp;<span class="caps">DOT</span>.</em> </p>
<div id="spicebeam"></div>

<p style="text-align: right;" class="source small"><strong>Source: <a href="http://www.iowadot.gov/">Iowa&nbsp;<span class="caps">DOT</span></a></strong></p>

<p>If you drive in Iowa—on the interstate, at least—you can&#8217;t miss the highway alert signs. I remember seeing these growing up in <span class="caps">LA</span>. They were usually switched off or had a nursery rhyme reminding you to buckle up.. I never once thought, &#8220;what a missed&nbsp;opportunity!&#8221; </p>
<p>They are not such dull thinkers in Iowa. Here, in the famously mild-mannered midwest, the highway signs have real sass. When we arrived and began our daily commute (Iowa City to Cedar Rapids), we immediately noticed the&nbsp;signs. </p>
<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="4" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div> <p style=" margin:8px 0 0 0; padding:0 4px;"> <a href="https://instagram.com/p/yUdp65JmMg/" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_top">I often wonder about the Iowa <span class="caps">DOT</span> official in charge of the weekly sign&nbsp;change.</a></p> <p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">A photo posted by Madison (@melizbre) on <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2015-01-26T14:00:40+00:00">Jan 26, 2015 at 6:00am <span class="caps">PST</span></time></p></div></blockquote>

<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

<p><br>
<span class="dquo">&#8220;</span><span class="caps">IN</span> <span class="caps">THE</span> <span class="caps">BLINK</span> <span class="caps">OF</span> <span class="caps">AN</span> <span class="caps">EYE</span>, <span class="caps">YOU</span> <span class="caps">COULD</span> <span class="caps">DIE</span>.&#8221; Good morning to you, too. These signs alternate with a sobering daily ticker — &#8220;34 traffic deaths so far this year.&#8221; Driving is serious stuff. That aside, the signs bring some humor and a note of (morbid) grace to the gray morning&nbsp;commute.</p>
<p>I decided to learn more. I wanted all the&nbsp;signs.  </p>
<p>The IowaDOT has extensive resources online, including an impressive interactive map of the state&#8217;s roadways, not to mention a surprisingly comprehensive staff <a href="http://www.iowadot.gov/phonebook.htm">phone book</a>. That said, they&#8217;re much more interested in relaying information about current traffic conditions than historical&nbsp;ones.</p>
<p>I got in touch with a few friendly folks out there—muckraking this ain&#8217;t—and after after some back and forth, they encouraged me to file a <span class="caps">FOIA</span> request. With the friendly help of the <a href="http://foiamachine.org"><span class="caps">FOIA</span> Machine</a> and the <a href="http://www.foia.gov/how-to.html"><span class="caps">USA</span></a> I learned that this was a codeword for &#8220;email with the magic words &#8216;<span class="caps">FOIA</span> request&#8217; in it.&#8221; Done. I immediately received a vacation auto-responder. Not bad. Not&nbsp;great.  </p>
<p>Nonetheless, about ten days later, an an <span class="caps">EXCEL</span> file with 82 weeks worth of sign messages and dates was gleaming in my inbox. What I didn&#8217;t have, though, was any numerical data. Another request turned that around quickly—traffic data is easy, because it&#8217;s clear that agencies monitor this stuff very closely themselves. The trick, I suppose, is to get at the data that people <em>don&#8217;t</em> want to know. At any rate, another lovely <span class="caps">EXCEL</span> file in hand, I summed by weeks (not knowing the way to do this right in Excel, I generated the appropriate sum formulas, =<span class="caps">SUM</span>(B7:B13) in Python and pasted em&#8217;&nbsp;in).  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># print =<span class="caps">SUM</span>(<span class="caps">BX</span>:<span class="caps">BX</span>+n)</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">interval</span> <span class="o">=</span> <span class="mi">6</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">52</span><span class="p">):</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">interval</span>
    <span class="k">print</span> <span class="s">&quot;=<span class="caps">SUM</span>(B</span><span class="si">%d</span><span class="s">:B</span><span class="si">%d</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>  
    <span class="n">start</span> <span class="o">+=</span> <span class="n">interval</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<p>Ha! I felt brilliant and stupid all at once. Honestly, I find it a lot more readable than the cryptic offset(&#8230;) Excel soutions, and easier than doing it all in Python. Numbers so summed, I turned to <code>d3.js</code>, the much beloved visual library. I learned a few things in getting up to speed. Having spent quite a bit of time working with <code>jQuery</code>, it was a pleasure to use a library that offered a bit more out-of-the-box&nbsp;functionality.</p>
<p>For those looking to get into gear, the basic beginning tutorials on <a href="http://d3js.org">d3js.org</a>—are really useful. The list of tutorials <a href="https://github.com/mbostock/d3/wiki/Tutorials">here</a> is hit or miss, but there are some great ones too. I&#8217;d recommending reading Bostock&#8217;s <a href="http://bost.ocks.org/mike/join/">write-ups</a> on <a href="http://bost.ocks.org/mike/selection/">joins</a> more than anything else, as that explains the basics of the whole chaining syntax. I struggled somewhat with the scales, as well. It&#8217;s just the kind&#8217;ve thing that takes a little&nbsp;banging.</p>
<p>It&#8217;s interesting how rapidly patterns become clear. Traffic accidents spike immediately before&nbsp;Thanksgiving.  </p>
<p>The full <span class="caps">CSV</span> is available for download <a href="/media/files/message_mondays.csv">here</a>.</p>    </section>
    <footer>
        <h3>Change History<a class="sup" href="/posts/2013/1/31/tracking">(?)</a></h3>
<section id="commit-log">
<h4><time class="timeago" datetime="2015-04-16 17:48:43">2015-04-16 17:48:43</time>: <span class="message"> Adding tooltips for grand visual effect.
</span> <a class="link" href="#cca423fb54ae8645f22617c9e75cc3e59e215a03" id="cca423fb54ae8645f22617c9e75cc3e59e215a03">&raquo;</a> </h4> 
<div class="changeset">
    <pre class="hash">Find <a href="https://github.com/samjacoby/samjacoby.com/commit/cca423fb54ae8645f22617c9e75cc3e59e215a03">cca423fb54ae8645f22617c9e75cc3e59e215a03</a> on GitHub.</pre>
    <pre class="message">Adding tooltips for grand visual effect.
</pre>
    <pre class="diff">.range([height, -2]);

var hueScale = d3.scale.linear()
[-.rangeRound([140, 20]);-]{+.rangeRound([100, 11]);+}

var xTime = d3.time.scale()
.range([2, width]);
@@ -36,12 +36,30 @@ var yAxis = d3.svg.axis()
.orient(&#34;left&#34;)
.ticks(10);


{+var msg = d3.select(&#34;body&#34;).append(&#34;div&#34;)+}
{+  .attr(&#34;class&#34;, &#34;tooltip&#34;)+}
{+  .style(&#34;opacity&#34;, 1e-6);+}

{+  format = d3.time.format(&#34;%m-%d-%Y&#34;);+}
{+  var mouseOver = function(el) {+}
{+    msg.html(&#34;&lt;p&gt;&lt;strong&gt;&#34;+ format(el.date) + &#34;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&#34; + el.message + &#34;&lt;/p&gt;&#34;)+}
{+    .style(&#34;opacity&#34;, 1);  +}
{+}+}

{+function mouseMove() {+}
{+  msg+}
{+    .style(&#34;left&#34;, d3.event.pageX + &#34;px&#34;)+}
{+    .style(&#34;top&#34;, (d3.event.pageY - 100) + &#34;px&#34;);+}
{+}+}

var svg = d3.select(&#34;#spicebeam&#34;).append(&#34;svg&#34;)
.attr(&#34;width&#34;, width + margin.left + margin.right)
.attr(&#34;height&#34;, height + margin.top + margin.bottom)
.append(&#34;g&#34;)
.attr(&#34;transform&#34;, &#34;translate(&#34; + margin.left + &#34;,&#34; + margin.top + &#34;)&#34;);


d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
x.domain(data.map(function(d) { return d.date; }));
xTime.domain([d3.min(data, function(d) { return d.date }), d3.max(data, function(d) { return d.date; })])
@@ -69,14 +87,7 @@ d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
.attr(&#34;dy&#34;, &#34;.71em&#34;)
.style(&#34;text-anchor&#34;, &#34;end&#34;)
.text(&#34;Crashes (weekly)&#34;);
[-var message = d3.select(&#34;#message&#34;)-]
[-      format = d3.time.format(&#34;%m-%d-%Y&#34;);-]
[-  var displayMessage = function(el){-]
[-    var formDate = format(el.date);  -]
[-    message.text(&#34;MSG: &#34; + el.message).append(&#34;span&#34;).text(&#34; [&#34; + formDate + &#34;]&#34;);-]
[-  }-]
svg.selectAll(&#34;.bar&#34;)
.data(data)
.enter().append(&#34;rect&#34;)
@@ -86,14 +97,14 @@ d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
.attr(&#34;y&#34;, function(d) { return y(d.crashes); })
.attr(&#34;height&#34;, function(d) { return height - y(d.crashes); })
.attr(&#34;fill&#34;, function(d) {
[-          //if(d.date &lt; new Date(&#34;12/30/2014&#34;))-]
if(d.crashes != 700) {
{+// hack to display gray where I don&#39;t have data+}
return &#34;hsl(&#34; + hueScale(d.crashes)  + &#34;,90%,50%)&#34;;
}
return &#34;#aaa&#34;;
})
.on(&#39;mouseover&#39;, [-displayMessage);-]{+mouseOver)+}
{+      .on(&#39;mousemove&#39;, mouseMove);+}
});

function type(d) {
@@ -102,7 +113,6 @@ function type(d) {
d.crashes = +d.crashes;
return d;
}

&lt;/script&gt;
{% endblock %}

@@ -111,7 +121,6 @@ function type(d) {

&lt;div id=&#34;spicebeam&#34;&gt;&lt;/div&gt;
&lt;p style=&#34;text-align: right;&#34; class=&#34;source small&#34;&gt;&lt;strong&gt;Source: &lt;a href=&#34;http://www.iowadot.gov/&#34;&gt;Iowa DOT&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
[-&lt;h2 id=&#34;message&#34;&gt;MSG: 156 Traffic Deaths this Year - Don&#39;t Add to this number&lt;span&gt;[08-05-2013]&lt;/span&gt;&lt;/h2&gt;-]
{% mark excerpt %}
If you drive in Iowa—on the interstate, at least—you can&#39;t miss the highway alert signs. I remember seeing these growing up in LA. They were usually switched off or had a nursery rhyme reminding you to buckle up.. I never once thought, &#34;what a missed opportunity!&#34;
{% endmark %}
@@ -131,22 +140,23 @@ The IowaDOT has extensive resources online, including an impressive interactive

I got in touch with a few friendly folks out there—muckraking this ain&#39;t—and after after some back and forth, they encouraged me to file a FOIA request. With the friendly help of the [FOIA Machine](http://foiamachine.org) and the [USA](http://www.foia.gov/how-to.html) I learned that this was a codeword for &#34;email with the magic words &#39;FOIA request&#39; in it.&#34; Done. I immediately received a vacation auto-responder. Not bad. Not great.

Nonetheless, about ten days later, an {+an+} EXCEL file [-courtesy of the IowaDOT:-]{+with+} 82 weeks worth of sign messages and [-dates.-]{+dates was gleaming in my inbox.+} What I didn&#39;t have, though, was any numerical data. [-I&#39;ve put in-]{+Another request turned that around quickly—traffic data is easy, because it&#39;s clear that agencies monitor this stuff very closely themselves. The trick, I suppose, is to get at the data that people *don&#39;t* want to know. At any rate,+} another [-request—but-]{+lovely EXCEL file+} in {+hand, I summed by weeks (not knowing+} the [-meantime,-]{+way to do this right in Excel,+} I generated [-some numbers with a quick python script.-]{+the appropriate sum formulas, =SUM(B7:B13) in Python and pasted em&#39; in).+}

#!/usr/bin/env python
[-import random-]{+# print =SUM(BX:BX+n)+}
{+    start = 8+}
{+    interval = 6+}
{+    for i in range(52):+}
{+        end = start + interval+}
{+        print &#34;=SUM(B%d:B%d)&#34; % (start, end)  +}
{+        start += interval + 1+}

[-random.seed()-]
[-    for x-]{+Ha! I felt brilliant and stupid all at once. Honestly, I find it a lot more readable than the cryptic offset(...) Excel soutions, and easier than doing it all+} in [-range(0, 82):-]
[-      print random.randrange(13, 114, 1)-]{+Python. Numbers so summed, I turned to `d3.js`, the much beloved visual library. I learned a few things in getting up to speed. Having spent quite a bit of time working with `jQuery`, it was a pleasure to use a library that offered a bit more out-of-the-box functionality.+}

[-With that, I turned-]{+For those looking+} to [-`d3.js`,-]{+get into gear,+} the [-much beloved visual library. I learned a few things in getting up to speed. Having spent quite a bit-]{+basic beginning tutorials on [d3js.org](http://d3js.org)—are really useful. The list of tutorials [here](https://github.com/mbostock/d3/wiki/Tutorials) is hit or miss, but there are some great ones too. I&#39;d recommending reading Bostock&#39;s [write-ups](http://bost.ocks.org/mike/join/) on [joins](http://bost.ocks.org/mike/selection/) more than anything else, as that explains the basics+} of [-time working-]{+the whole chaining syntax. I struggled somewhat+} with [-`jQuery`, it was a pleasure to use a library-]{+the scales, as well. It&#39;s just the kind&#39;ve thing+} that [-offered-]{+takes+} a [-bit more out-of-the-box functionality.-]{+little banging.+}

[-For those looking to get into gear, the basic beginning tutorials on [d3js.org](http://d3js.org)—are really useful. The list of tutorials [here](https://github.com/mbostock/d3/wiki/Tutorials) is hit or miss, but there are some great ones too. I&#39;d recommending reading Bostock&#39;s [write-ups](http://bost.ocks.org/mike/join/) on [joins](http://bost.ocks.org/mike/selection/) more than anything else, as that explains the basics of the whole chaining syntax. I struggled somewhat with the scales, as well.-]It&#39;s [-just the kind&#39;ve thing that takes a little headbeating.-]{+interesting how rapidly patterns become clear. Traffic accidents spike immediately before Thanksgiving.+}

The full CSV is available for download [here](/media/files/message_mondays.csv).

[- **Update:** I just heard back from the DOT with the full accident data, so I&#39;ll get that up soon!-]


{% endblock %}</pre>
<hr>
</div>
<h4><time class="timeago" datetime="2015-03-05 12:06:30">2015-03-05 12:06:30</time>: <span class="message"> Updating with real accident data (obtained Mar 3, 2015)
</span> <a class="link" href="#edbbd2e3e0f2849a1d419814e3b7379eb2bd8f60" id="edbbd2e3e0f2849a1d419814e3b7379eb2bd8f60">&raquo;</a> </h4> 
<div class="changeset">
    <pre class="hash">Find <a href="https://github.com/samjacoby/samjacoby.com/commit/edbbd2e3e0f2849a1d419814e3b7379eb2bd8f60">edbbd2e3e0f2849a1d419814e3b7379eb2bd8f60</a> on GitHub.</pre>
    <pre class="message">Updating with real accident data (obtained Mar 3, 2015)
</pre>
    <pre class="diff">track: True
---
{% block tail_scripts %}
&lt;script [-src=&#34;http://d3js.org/d3.v3.min.js&#34;&gt;&lt;/script&gt;-]{+src=&#34;/media/js/d3.v3.min.js&#34;&gt;&lt;/script&gt;+}
&lt;script type=&#34;text/javascript&#34;&gt;
var margin = {top: 20, right: 20, bottom: 30, left: [-30},-]{+40},+}
width = 960 - margin.left - margin.right,
height = 350 - margin.top - margin.bottom;

@@ -19,7 +19,7 @@ var y = d3.scale.linear()
.range([height, -2]);

var hueScale = d3.scale.linear()
[-.rangeRound([120, 0]);-]{+.rangeRound([140, 20]);+}

var xTime = d3.time.scale()
.range([2, width]);
@@ -44,11 +44,10 @@ var svg = d3.select(&#34;#spicebeam&#34;).append(&#34;svg&#34;)

d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
x.domain(data.map(function(d) { return d.date; }));
[-  //xTime.domain(data.map(function(d) { return d.date; }))-]
xTime.domain([d3.min(data, function(d) { return d.date }), d3.max(data, function(d) { return d.date; })])

y.domain([0, d3.max(data, function(d) { return [-d.test;-]{+d.crashes;+} })]);
hueScale.domain([0, d3.max(data, function(d) { return [-d.test;-]{+d.crashes;+} })]);

svg.append(&#34;g&#34;)
.attr(&#34;class&#34;, &#34;x axis&#34;)
@@ -69,13 +68,13 @@ d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
.attr(&#34;y&#34;, 6)
.attr(&#34;dy&#34;, &#34;.71em&#34;)
.style(&#34;text-anchor&#34;, &#34;end&#34;)
[-.text(&#34;Crashes&#34;);-]{+.text(&#34;Crashes (weekly)&#34;);+}

var message = d3.select(&#34;#message&#34;)
format = d3.time.format(&#34;%m-%d-%Y&#34;);
var displayMessage = function(el){
var formDate = format(el.date);
[-message.text(el.message).append(&#34;span&#34;).text(&#34;-]{+message.text(&#34;MSG: &#34; + el.message).append(&#34;span&#34;).text(&#34;+} [&#34; + formDate + &#34;]&#34;);
}

svg.selectAll(&#34;.bar&#34;)
@@ -84,10 +83,14 @@ d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
.attr(&#34;class&#34;, &#34;bar&#34;)
.attr(&#34;x&#34;, function(d) { return xTime(d.date); })
.attr(&#34;width&#34;, x.rangeBand())
.attr(&#34;y&#34;, function(d) { return [-y(d.test);-]{+y(d.crashes);+} })
.attr(&#34;height&#34;, function(d) { return height - [-y(d.test);-]{+y(d.crashes);+} })
.attr(&#34;fill&#34;, function(d) {
{+//if(d.date &lt; new Date(&#34;12/30/2014&#34;))+}
{+          if(d.crashes != 700) {+}
return &#34;hsl(&#34; + [-hueScale(d.test)-]{+hueScale(d.crashes)+}  + &#34;,90%,50%)&#34;;
{+}+}
{+          return &#34;#aaa&#34;;+}
})
.on(&#39;mouseover&#39;, displayMessage);

@@ -96,7 +99,7 @@ d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {
function type(d) {
//d.date = +d.date;
d.date = new Date(d.date)
[-d.test-]{+d.crashes+} = [-+d.test;-]{++d.crashes;+}
return d;
}

@@ -104,11 +107,13 @@ function type(d) {
{% endblock %}

{% block post %}
{+*In this project, I looked at the freeway digital sign alerts in Iowa charted against statewide accident totals, both obtained via FOIA requests to the Iowa DOT.*+}

&lt;div id=&#34;spicebeam&#34;&gt;&lt;/div&gt;
{+&lt;p style=&#34;text-align: right;&#34; class=&#34;source small&#34;&gt;&lt;strong&gt;Source: &lt;a href=&#34;http://www.iowadot.gov/&#34;&gt;Iowa DOT&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;+}
&lt;h2 [-id=&#34;message&#34;&gt;156-]{+id=&#34;message&#34;&gt;MSG: 156+} Traffic Deaths this Year - Don&#39;t Add to this number&lt;span&gt;[08-05-2013]&lt;/span&gt;&lt;/h2&gt;[-&lt;p class=&#34;small&#34;&gt;Note: this graph is for illustration purposes only.&lt;/p&gt;-]
{% mark excerpt %}
If you drive in Iowa—on the interstate, at least—you can&#39;t miss the highway alert signs. I remember seeing these growing up in LA. They were usually switched off or had a [-nurery-]{+nursery+} rhyme reminding you to buckle up.. I never once thought, &#34;what a missed opportunity!&#34;
{% endmark %}

They are not such dull thinkers in Iowa. Here, in the famously mild-mannered midwest, the highway signs have real sass. When we arrived and began our daily commute (Iowa City to Cedar Rapids), we immediately noticed the signs.
@@ -139,7 +144,7 @@ Nonetheless, about ten days later, an EXCEL file courtesy of the IowaDOT: 82 wee

For those looking to get into gear, the basic beginning tutorials on [d3js.org](http://d3js.org)—are really useful. The list of tutorials [here](https://github.com/mbostock/d3/wiki/Tutorials) is hit or miss, but there are some great ones too. I&#39;d recommending reading Bostock&#39;s [write-ups](http://bost.ocks.org/mike/join/) on [joins](http://bost.ocks.org/mike/selection/) more than anything else, as that explains the basics of the whole chaining syntax. I struggled somewhat with the scales, as well. It&#39;s just the kind&#39;ve thing that takes a little headbeating.

The full CSV is [-avalailable-]{+available+} for download [here](/media/files/message_mondays.csv).

**Update:** I just heard back from the DOT with the full accident data, so I&#39;ll get that up soon!</pre>
<hr>
</div>
<h4><time class="timeago" datetime="2015-03-03 12:54:37">2015-03-03 12:54:37</time>: <span class="message"> Add latest news (accident data).
</span> <a class="link" href="#43762c1345a69d1927e3f28cfd430482aa6734c7" id="43762c1345a69d1927e3f28cfd430482aa6734c7">&raquo;</a> </h4> 
<div class="changeset">
    <pre class="hash">Find <a href="https://github.com/samjacoby/samjacoby.com/commit/43762c1345a69d1927e3f28cfd430482aa6734c7">43762c1345a69d1927e3f28cfd430482aa6734c7</a> on GitHub.</pre>
    <pre class="message">Add latest news (accident data).
</pre>
    <pre class="diff">{% block post %}
&lt;div id=&#34;spicebeam&#34;&gt;&lt;/div&gt;
[-&lt;h3-]{+&lt;h2+} id=&#34;message&#34;&gt;156 Traffic Deaths this Year - Don&#39;t Add to this [-number&lt;span&gt;[08-05-2013]&lt;/span&gt;&lt;/h3&gt;-]{+number&lt;span&gt;[08-05-2013]&lt;/span&gt;&lt;/h2&gt;+}
&lt;p class=&#34;small&#34;&gt;Note: this graph is for illustration purposes only.&lt;/p&gt;
{% mark excerpt %}
If you drive in Iowa—on the interstate, at least—you can&#39;t miss the highway alert signs. I remember seeing these growing up in LA. They were usually switched off or had a nurery rhyme reminding you to buckle up.. I never once thought, &#34;what a missed opportunity!&#34;
@@ -141,5 +141,7 @@ Nonetheless, about ten days later, an EXCEL file courtesy of the IowaDOT: 82 wee

The full CSV is avalailable for download [here](/media/files/message_mondays.csv).

{+**Update:** I just heard back from the DOT with the full accident data, so I&#39;ll get that up soon!+}


{% endblock %}</pre>
<hr>
</div>
<h4><time class="timeago" datetime="2015-03-02 21:45:41">2015-03-02 21:45:41</time>: <span class="message"> Adding message mondays to the mix.
</span> <a class="link" href="#baf7a458c0da1f5710a418c5b644479db3157b95" id="baf7a458c0da1f5710a418c5b644479db3157b95">&raquo;</a> </h4> 
<div class="changeset">
    <pre class="hash">Find <a href="https://github.com/samjacoby/samjacoby.com/commit/baf7a458c0da1f5710a418c5b644479db3157b95">baf7a458c0da1f5710a418c5b644479db3157b95</a> on GitHub.</pre>
    <pre class="message">Adding message mondays to the mix.
</pre>
    <pre class="diff">@@ -0,0 +1,145 @@
{+---+}
{+title: Message Mondays +}
{+summary: My first FOIA request, d3.js, and Iowa DOT&#39;s sassy highway signs.  +}
{+thumbnail: message_mondays.jpg+}
{+date: 2015-03-01 14:08:56+}
{+track: True+}
{+---+}
{+{% block tail_scripts %}+}
{+&lt;script src=&#34;http://d3js.org/d3.v3.min.js&#34;&gt;&lt;/script&gt;+}
{+&lt;script type=&#34;text/javascript&#34;&gt;+}
{+var margin = {top: 20, right: 20, bottom: 30, left: 30},+}
{+    width = 960 - margin.left - margin.right,+}
{+    height = 350 - margin.top - margin.bottom;+}

{+var x = d3.scale.ordinal()+}
{+    .rangeRoundBands([0, width], .06);+}

{+var y = d3.scale.linear()+}
{+    .range([height, -2]);+}

{+var hueScale = d3.scale.linear()+}
{+    .rangeRound([120, 0]);+}

{+var xTime = d3.time.scale()+}
{+    .range([2, width]);+}

{+var xAxis = d3.svg.axis()+}
{+    .scale(xTime)+}
{+    .orient(&#34;bottom&#34;)+}
{+    .tickFormat(d3.time.format(&#34;%b %y&#34;))+}
{+    .ticks(d3.time.months, 1);+}


{+var yAxis = d3.svg.axis()+}
{+    .scale(y)+}
{+    .orient(&#34;left&#34;)+}
{+    .ticks(10);+}

{+var svg = d3.select(&#34;#spicebeam&#34;).append(&#34;svg&#34;)+}
{+    .attr(&#34;width&#34;, width + margin.left + margin.right)+}
{+    .attr(&#34;height&#34;, height + margin.top + margin.bottom)+}
{+  .append(&#34;g&#34;)+}
{+    .attr(&#34;transform&#34;, &#34;translate(&#34; + margin.left + &#34;,&#34; + margin.top + &#34;)&#34;);+}

{+d3.csv(&#34;/media/files/message_mondays.csv&#34;, type, function(error, data) {+}
{+  x.domain(data.map(function(d) { return d.date; }));+}
{+  //xTime.domain(data.map(function(d) { return d.date; }))+}
{+  xTime.domain([d3.min(data, function(d) { return d.date }), d3.max(data, function(d) { return d.date; })])+}

{+  y.domain([0, d3.max(data, function(d) { return d.test; })]);+}
{+  hueScale.domain([0, d3.max(data, function(d) { return d.test; })]);+}

{+  svg.append(&#34;g&#34;)+}
{+      .attr(&#34;class&#34;, &#34;x axis&#34;)+}
{+      .attr(&#34;transform&#34;, &#34;translate(0,&#34; + height + &#34;)&#34;)+}
{+      .call(xAxis)+}
{+      .selectAll(&#34;text&#34;)+}
{+      .attr(&#34;y&#34;, &#34;16&#34;)+}
{+      .attr(&#34;x&#34;, &#34;0&#34;)+}
{+      .attr(&#34;dy&#34;, &#34;.35em&#34;)+}
{+      .attr(&#34;transform&#34;, &#34;rotate(0)&#34;)+}
{+      .style(&#34;text-anchor&#34;, &#34;start&#34;);+}

{+  svg.append(&#34;g&#34;)+}
{+      .attr(&#34;class&#34;, &#34;y axis&#34;)+}
{+      .call(yAxis)+}
{+    .append(&#34;text&#34;)+}
{+      .attr(&#34;transform&#34;, &#34;rotate(-90)&#34;)+}
{+      .attr(&#34;y&#34;, 6)+}
{+      .attr(&#34;dy&#34;, &#34;.71em&#34;)+}
{+      .style(&#34;text-anchor&#34;, &#34;end&#34;)+}
{+      .text(&#34;Crashes&#34;);+}

{+  var message = d3.select(&#34;#message&#34;)+}
{+      format = d3.time.format(&#34;%m-%d-%Y&#34;);+}
{+  var displayMessage = function(el){+}
{+    var formDate = format(el.date);  +}
{+    message.text(el.message).append(&#34;span&#34;).text(&#34; [&#34; + formDate + &#34;]&#34;);+}
{+  }+}

{+  svg.selectAll(&#34;.bar&#34;)+}
{+      .data(data)+}
{+    .enter().append(&#34;rect&#34;)+}
{+      .attr(&#34;class&#34;, &#34;bar&#34;)+}
{+      .attr(&#34;x&#34;, function(d) { return xTime(d.date); })+}
{+      .attr(&#34;width&#34;, x.rangeBand())+}
{+      .attr(&#34;y&#34;, function(d) { return y(d.test); })+}
{+      .attr(&#34;height&#34;, function(d) { return height - y(d.test); })+}
{+      .attr(&#34;fill&#34;, function(d) { +}
{+        return &#34;hsl(&#34; + hueScale(d.test)  + &#34;,90%,50%)&#34;; +}
{+      })+}
{+      .on(&#39;mouseover&#39;, displayMessage);+}

{+});+}

{+function type(d) {+}
{+  //d.date = +d.date;+}
{+  d.date = new Date(d.date)  +}
{+  d.test = +d.test;+}
{+  return d;+}
{+}+}

{+&lt;/script&gt;+}
{+{% endblock %}+}

{+{% block post %}+}
{+&lt;div id=&#34;spicebeam&#34;&gt;&lt;/div&gt;+}
{+&lt;h3 id=&#34;message&#34;&gt;156 Traffic Deaths this Year - Don&#39;t Add to this number&lt;span&gt;[08-05-2013]&lt;/span&gt;&lt;/h3&gt;+}
{+&lt;p class=&#34;small&#34;&gt;Note: this graph is for illustration purposes only.&lt;/p&gt;+}
{+{% mark excerpt %}+}
{+If you drive in Iowa—on the interstate, at least—you can&#39;t miss the highway alert signs. I remember seeing these growing up in LA. They were usually switched off or had a nurery rhyme reminding you to buckle up.. I never once thought, &#34;what a missed opportunity!&#34; +}
{+{% endmark %}+}

{+They are not such dull thinkers in Iowa. Here, in the famously mild-mannered midwest, the highway signs have real sass. When we arrived and began our daily commute (Iowa City to Cedar Rapids), we immediately noticed the signs. +}


{+&lt;blockquote class=&#34;instagram-media&#34; data-instgrm-captioned data-instgrm-version=&#34;4&#34; style=&#34; background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);&#34;&gt;&lt;div style=&#34;padding:8px;&#34;&gt; &lt;div style=&#34; background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;&#34;&gt; &lt;div style=&#34; background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;&#34;&gt;&lt;/div&gt;&lt;/div&gt; &lt;p style=&#34; margin:8px 0 0 0; padding:0 4px;&#34;&gt; &lt;a href=&#34;https://instagram.com/p/yUdp65JmMg/&#34; style=&#34; color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;&#34; target=&#34;_top&#34;&gt;I often wonder about the Iowa DOT official in charge of the weekly sign change.&lt;/a&gt;&lt;/p&gt; &lt;p style=&#34; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;&#34;&gt;A photo posted by Madison (@melizbre) on &lt;time style=&#34; font-family:Arial,sans-serif; font-size:14px; line-height:17px;&#34; datetime=&#34;2015-01-26T14:00:40+00:00&#34;&gt;Jan 26, 2015 at 6:00am PST&lt;/time&gt;&lt;/p&gt;&lt;/div&gt;&lt;/blockquote&gt;+}
{+&lt;script async defer src=&#34;//platform.instagram.com/en_US/embeds.js&#34;&gt;&lt;/script&gt;+}

{+&lt;br&gt;+}
{+&#34;IN THE BLINK OF AN EYE, YOU COULD DIE.&#34; Good morning to you, too. These signs alternate with a sobering daily ticker — &#34;34 traffic deaths so far this year.&#34; Driving is serious stuff. That aside, the signs bring some humor and a note of (morbid) grace to the gray morning commute.+}

{+I decided to learn more. I wanted all the signs.  +}

{+The IowaDOT has extensive resources online, including an impressive interactive map of the state&#39;s roadways, not to mention a surprisingly comprehensive staff [phone book](http://www.iowadot.gov/phonebook.htm). That said, they&#39;re much more interested in relaying information about current traffic conditions than historical ones.+}

{+I got in touch with a few friendly folks out there—muckraking this ain&#39;t—and after after some back and forth, they encouraged me to file a FOIA request. With the friendly help of the [FOIA Machine](http://foiamachine.org) and the [USA](http://www.foia.gov/how-to.html) I learned that this was a codeword for &#34;email with the magic words &#39;FOIA request&#39; in it.&#34; Done. I immediately received a vacation auto-responder. Not bad. Not great.  +}

{+Nonetheless, about ten days later, an EXCEL file courtesy of the IowaDOT: 82 weeks worth of sign messages and dates. What I didn&#39;t have, though, was any numerical data. I&#39;ve put in another request—but in the meantime, I generated some numbers with a quick python script. +}

{+    #!/usr/bin/env python+}
{+    import random+}

{+    random.seed()+}
{+    for x in range(0, 82):+}
{+      print random.randrange(13, 114, 1) +}

{+ With that, I turned to `d3.js`, the much beloved visual library. I learned a few things in getting up to speed. Having spent quite a bit of time working with `jQuery`, it was a pleasure to use a library that offered a bit more out-of-the-box functionality.+}

{+ For those looking to get into gear, the basic beginning tutorials on [d3js.org](http://d3js.org)—are really useful. The list of tutorials [here](https://github.com/mbostock/d3/wiki/Tutorials) is hit or miss, but there are some great ones too. I&#39;d recommending reading Bostock&#39;s [write-ups](http://bost.ocks.org/mike/join/) on [joins](http://bost.ocks.org/mike/selection/) more than anything else, as that explains the basics of the whole chaining syntax. I struggled somewhat with the scales, as well. It&#39;s just the kind&#39;ve thing that takes a little headbeating.    +}

{+ The full CSV is avalailable for download [here](/media/files/message_mondays.csv).+}


{+{% endblock %}+}</pre>
<hr>
</div>
</section>
    </footer>
 </article>
        </article>
        <footer id="colophon">
            <div class="inner">
            </div>
        </footer>

                <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34337252-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>        <script>hljs.initHighlightingOnLoad();</script>
        <script src="/media/js/d3.v3.min.js"></script>
<script type="text/javascript">
var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 350 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .06);

var y = d3.scale.linear()
    .range([height, -2]);

var hueScale = d3.scale.linear()
    .rangeRound([100, 11]);

var xTime = d3.time.scale()
    .range([2, width]);

var xAxis = d3.svg.axis()
    .scale(xTime)
    .orient("bottom")
    .tickFormat(d3.time.format("%b %y"))
    .ticks(d3.time.months, 1);


var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .ticks(10);


var msg = d3.select("body").append("div")
  .attr("class", "tooltip")
  .style("opacity", 1e-6);

  format = d3.time.format("%m-%d-%Y");
  var mouseOver = function(el) {
    msg.html("<p><strong>"+ format(el.date) + "</strong></p><p>" + el.message + "</p>")
    .style("opacity", 1);  
}

function mouseMove() {
  msg
    .style("left", d3.event.pageX + "px")
    .style("top", (d3.event.pageY - 100) + "px");
}

var svg = d3.select("#spicebeam").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


d3.csv("/media/files/message_mondays.csv", type, function(error, data) {
  x.domain(data.map(function(d) { return d.date; }));
  xTime.domain([d3.min(data, function(d) { return d.date }), d3.max(data, function(d) { return d.date; })])

  y.domain([0, d3.max(data, function(d) { return d.crashes; })]);
  hueScale.domain([0, d3.max(data, function(d) { return d.crashes; })]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")
      .attr("y", "16")
      .attr("x", "0")
      .attr("dy", ".35em")
      .attr("transform", "rotate(0)")
      .style("text-anchor", "start");

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Crashes (weekly)");
  
  svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return xTime(d.date); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.crashes); })
      .attr("height", function(d) { return height - y(d.crashes); })
      .attr("fill", function(d) { 
          if(d.crashes != 700) {
            // hack to display gray where I don't have data
            return "hsl(" + hueScale(d.crashes)  + ",90%,50%)"; 
          }
          return "#aaa";
      })
      .on('mouseover', mouseOver)
      .on('mousemove', mouseMove);
});

function type(d) {
  //d.date = +d.date;
  d.date = new Date(d.date)  
  d.crashes = +d.crashes;
  return d;
}
</script>
    </body>
</html>