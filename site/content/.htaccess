RewriteEngine on 
RewriteBase / 

ErrorDocument 404 /404.html

# Don't fix direct file links
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ $1/ [L,R=301]

RewriteCond %{REQUEST_FILENAME} (.*jpg)/$ 
RewriteRule ^(.*) $1

RewriteCond %{REQUEST_FILENAME}/index.html -f 
RewriteRule ^(.*) $1/index.html 

RewriteCond %{REQUEST_FILENAME}/$1.html -f 
RewriteRule ([^/]*)/$ %{REQUEST_FILENAME}/$1.html 

RewriteCond %{REQUEST_FILENAME}.html -f 
RewriteRule ^.*$ %{REQUEST_FILENAME}.html 

RewriteCond %{REQUEST_FILENAME}/$1.xml -f 
RewriteRule ([^/]*)/$ %{REQUEST_FILENAME}/$1.xml 

